<% if notice %>
  <div class="alert alert-info" role="alert">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
    <%= notice %>
  </div>
<% end %>

<h1>Gank Session</h1>
<h3><%= @gank_session.start_time %> - <%= @gank_session.end_time %></h3>

<h2>Characters</h2>
<ul>
  <% @gank_session.characters.each do |character| %>
    <li><%= character.name %></li>
  <% end %>
</ul>
</ul>

<% if @gank_session.end_time.nil? %>
  <div>
    <%=
    link_to 'End Session',
    gank_session_end_path(@gank_session),
    method: :post,
    data: { confirm: 'Session over?' }
    %>
  </div>
<% end %>

<% if @gank_session.players_killed %>
  <h2>Players Killed</h2>
  <ul>
    <% @gank_session.players_killed.each do |pk| %>
      <li><%= pk %></li>
    <% end %>
  </ul>
<% end %>

<% if @gank_session.items_dropped %>
  <% items_dropped_half_length = @gank_session.items_dropped.length / 2 %>
  <h2>Items Dropped</h2>
  <div class="row">
    <table class="table-sm table-striped col-sm-6">
      <tbody>
        <% @gank_session.items_dropped.slice(0, items_dropped_half_length).each do |item| %>
          <tr>
            <td><%= image_tag item_icon(item['type'], item['quantity']), height: 42 %></td>
            <td><%= item['quantity'] %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <table class="table-sm table-striped col-sm-6">
      <tbody>
        <% @gank_session.items_dropped.slice(items_dropped_half_length, @gank_session.items_dropped.length).each do |item| %>
          <tr>
            <td><%= image_tag item_icon(item['type'], item['quantity']), height: 42 %></td>
            <td><%= item['quantity'] %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% end %>

<%= link_to 'Edit', edit_gank_session_path(@gank_session) %> |
<%= link_to 'Back', gank_sessions_path %>
